<h1>Tableau de Bord</h1>
<p>Bienvenue, <%= current_user.email %> !</p>

<% if current_user.admin? %>
  <h2>ðŸ“Š Tableau de bord Admin</h2>
  <p>Statistiques des ventes et gestion des commandes.</p>

  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Client</th>
        <th>Date</th>
        <th>Total (â‚¬)</th>
        <th>Statut</th>
        <% if current_user.admin? %>
          <th>Actions</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @orders.each do |order| %>
        <tr>
          <td>#<%= order.id %></td>
          <td><%= order.user.email %></td>
          <td><%= order.created_at.strftime("%d/%m/%Y") %></td>
          <td><%= number_to_currency(order.total_price, unit: "â‚¬") %></td>
          <td><%= order.status.capitalize %></td>

          <% if current_user.admin? %>
          <td>
            <% if order.status == "paid" %>
              <%= button_to "ExpÃ©dier", order_path(order, order: { status: "shipped" }), method: :patch, class: "btn btn-success btn-sm" %>
            <% end %>

            <%= button_to "Annuler", order_path(order), method: :delete, class: "btn btn-danger btn-sm", data: { confirm: "Voulez-vous vraiment annuler cette commande ?" } %>
          </td>
          <% end %>

        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <h2>ðŸ›’ Vos commandes</h2>
  <ul>
    <% @orders.each do |order| %>
      <li>Commande #<%= order.id %> - <%= order.created_at.strftime("%d/%m/%Y") %> - <strong><%= order.status.capitalize %></strong></li>
    <% end %>
  </ul>
<% end %>
